(this.webpackJsonpwarlords_copy_cat=this.webpackJsonpwarlords_copy_cat||[]).push([[0],{1495:function(t,e,n){"use strict";n.r(e);var r=n(129),a=n.n(r),i=n(563),c=n.n(i),o=(n(571),n(572),n(32)),s=n.n(o),u=n(75),l=n(105),h=n(107),d=n(106),m=n(171),f=n(108),y=102,p=102,b=10,g=2,v=8772,O="minimap",j=function(t){function e(){var t;return Object(u.a)(this,e),t=Object(h.a)(this,Object(d.a)(e).call(this,"UIScene")),o.Scene.call(Object(m.a)(t),{key:"UI",active:!1}),t}return Object(f.a)(e,t),Object(l.a)(e,[{key:"create",value:function(){var t=this.scene.get("GameScene");!function(t,e,n){var r=y,a=p,i=b,c=O,o=v,s=(a-g)/n,u={x:e/2,y:n/2},l={x:t.width-r-i,y:i};t.cameras.add(l.x,l.y,r,a).setZoom(s).setName(c).centerOn(u.x,u.y).setBackgroundColor(o)}(t,t.terrainLayer.width,t.terrainLayer.height);var e=t.players[0],n=this.add.text(20,20,"Current Player: ".concat(e.name(),", turn: ").concat(e.turn()),{fill:"#000000"});this.add.text(700,560,"End Turn",{fill:"#000000"}).setInteractive().on("pointerdown",(function(){t.target=null,t.movement.clear(),e.endTurn(),n.setText("Current Player: ".concat(e.name(),", turn: ").concat(e.turn()))}))}}]),e}(o.Scene),w=n(564),x=n(27),k=n(45),C=[2],T=[4,5,6],M=[8,9,10,11,12,13,14,15],S=[1],P=[3,7],I=function(t){function e(){return Object(u.a)(this,e),Object(h.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(f.a)(e,t),Object(l.a)(e,[{key:"createMapControls",value:function(){var t=o.Input.Keyboard.KeyCodes,e=t.Q,n=t.E,r=o.Cameras.Controls.SmoothedKeyControl,a=this.input.keyboard.createCursorKeys(),i=a.left,c=a.right,s={up:a.up,down:a.down,left:i,right:c,camera:this.camera,zoomIn:this.keyboard.addKey(e),zoomOut:this.keyboard.addKey(n),drag:.6,maxSpeed:200,acceleration:2.8};this.controls=new r(s)}},{key:"setupCamera",value:function(t,e){var n=this.camera,r=n.width,a=n.height;this.camera.setBounds(0,0,t,e),this.camera.setScroll(-r/2+t/2,-a/2+e/2)}},{key:"controls",get:function(){return this.mapControls},set:function(t){this.mapControls=t}},{key:"camera",get:function(){return this.cameras.main}},{key:"keyboard",get:function(){return this.input.keyboard}},{key:"width",get:function(){return this.game.config.width}},{key:"height",get:function(){return this.game.config.height}},{key:"finder",get:function(){return this.pathFinder},set:function(t){this.pathFinder=t}},{key:"movement",get:function(){return this.entityMover},set:function(t){this.entityMover=t}},{key:"minimap",get:function(){return this.minimapCamera},set:function(t){this.minimapCamera=t}},{key:"target",get:function(){return this.selectedTarget},set:function(t){this.selectedTarget=t}},{key:"terrainLayer",get:function(){return this.terrain},set:function(t){this.terrain=t}}]),e}(o.Scene),A=n(64),E=n(565),L=n.n(E),D=n(76),K={path:[],cost:0,totalCost:0,currentTurn:[],nextTurns:[],indicators:[],nextIndicators:[]},U=function(t,e,n,r){var a=t.add.graphics(),i=K,c=function(t){return t*n},s=function(t){return t*r},u=function(){a.destroy(),a=t.add.graphics(),i=K},l=function(t){var e=t.x,i=t.y,u={x:c(e)+n/2,y:s(i)+r/2},l=new o.Geom.Circle(u.x,u.y,8);return a.fillCircleShape(l),l},h=function(e){return function(){t.camera.stopFollow(e.body),u()}};return{move:function(n){return function(r){if(!r||r.length<=1)return u();if(i&&i.currentTurn.length&&Object(x.isEqual)(i.path,r))return function(e){var n=i,r=n.cost,a=n.currentTurn.map((function(t){var n=t.x,r=t.y;return{targets:e.body,x:{value:c(n),duration:200},y:{value:s(r),duration:200}}}));t.camera.startFollow(e.body),t.tweens.timeline({tweens:a,onComplete:h(e)}),e.spendMovement(r)}(n);u();var o=r.slice(1,r.length).reduce(function(t,e){return function(n,r){var a=r.x,i=r.y,c=n.cost,o=n.totalCost,s=n.currentTurn,u=n.nextTurns,l=t[i][a];return o+l<=e.movementPoints?Object(D.a)({},n,{cost:c+l,totalCost:o+l,currentTurn:[].concat(Object(A.a)(s),[{x:a,y:i}])}):Object(D.a)({},n,{nextTurns:[].concat(Object(A.a)(u),[{x:a,y:i}])})}}(e,n),Object(D.a)({},K,{path:r})),d=o.currentTurn,m=o.nextTurns;a.fillStyle(16777215,1),o.indicators=d.map(l),a.fillStyle(16711680,1),o.nextIndicators=m.map(l),i=o}},clear:u}},B={turn:1,name:"",money:0,armies:[],castles:[]},G=function t(e,n,r,a){var i=this;Object(u.a)(this,t),this.spendMovement=function(t){return i.movementPoints-=t},this.resetMovement=function(){return i.movementPoints=4},this.scene=e,this.movementPoints=4,this.body=e.physics.add.sprite(n,r,a).setDisplaySize(24,24).setDisplayOrigin(-42,-44)},z=function(t,e){var n=Object(D.a)({},B,{name:"Player ".concat(e)});return{state:n,name:function(){return n.name},turn:function(){return n.turn},endTurn:function(){n.armies.forEach((function(t){return t.resetMovement()})),n=Object(D.a)({},n,{turn:n.turn+1})},addArmy:function(e,r,a){var i=new G(t,e,r,a);return n=Object(D.a)({},n,{armies:[].concat(Object(A.a)(n.armies),[i])}),i}}},F=function(t,e){return{x:Math.floor(t/128),y:Math.floor(e/128)}},_=function(t){function e(){var t;return Object(u.a)(this,e),(t=Object(h.a)(this,Object(d.a)(e).call(this,"GameScene"))).onPointerDown=function(e){var n=e.worldX,r=e.worldY;if(t.target){var a=F(n,r),i=F(t.target.body.x,t.target.body.y),c=t.movement.move(t.target);try{t.finder.findPath(i.x,i.y,a.x,a.y,c),t.finder.calculate()}catch(o){console.error("Ups! Out of scope :S")}}},t.players=[],t}return Object(f.a)(e,t),Object(l.a)(e,[{key:"addPlayer",value:function(){var t=this.players.length,e=z(this,t);return this.players.push(e),e}},{key:"preload",value:function(){this.load.setBaseURL("".concat("/warlords-copy-cat")),this.load.image("tiles","tilesets/tileset-extruded.png"),this.load.image("warrior","warrior.png")}},{key:"create",value:function(){var t=this,e=function(t,e,n,r){var a,i=t.make.tilemap({tileWidth:128,tileHeight:128}),c=i.tileWidth,o=i.tileHeight,s=i.addTilesetImage("tilemap","tiles",c,o,1,2),u=i.createBlankDynamicLayer("terrain",s,0,0,n,r,c,o),l=new L.a.js;l.setGrid(e),l.setAcceptableTiles([].concat(Object(A.a)(C),Object(A.a)(S),Object(A.a)(T))),l.enableDiagonals();var h=[],d=function(t,e){return function(n,r,a,i){e.setTileCost(n,i),t[a]=t[a]||[],t[a][r]=i}}(h,l);return e.forEach((function(t,e){return t.forEach((function(t,n){a||Object(x.includes)(P,t)||(a={x:n,y:e}),u.putTileAt(t,n,e),Object(x.includes)(C,t)&&d(t,n,e,1),Object(x.includes)(T,t)&&d(t,n,e,2),Object(x.includes)(S,t)&&d(t,n,e,3)}))})),u=i.convertLayerToStatic(u),{map:i,finder:l,costMatrix:h,spawnPoint:a,terrainLayer:u}}(this,function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.random(),r=new w.Noise;r.seed(n);var a=12*t/100,i=0,c=0,o=0,s=0,u=Object(x.range)(e).map((function(e){return Object(x.range)(t).map((function(t){var n=r.perlin2(t/a,e/a);return i=n<i?n:i,c=n>c?n:c,n<0?o++:s++,n}))})),l=.45,h=l+.1,d=function(t){return t>=l&&t<h},m=function(t){return t<l},f=function(t){return!d(t)&&!m(t)},y=function(t,e,n){if(n-1<0||n+1>=t.length)return Object(x.sample)(P);if(e-1<0||e+1>=t.length)return Object(x.sample)(P);var r=Object(k.a)(i,c,t[n-1][e-1]),a=Object(k.a)(i,c,t[n-1][e]),o=Object(k.a)(i,c,t[n-1][e+1]),s=Object(k.a)(i,c,t[n][e-1]),u=Object(k.a)(i,c,t[n][e+1]),h=Object(k.a)(i,c,t[n+1][e-1]),d=Object(k.a)(i,c,t[n+1][e]),m=Object(k.a)(i,c,t[n+1][e+1]);return f(a)||f(s)||f(u)||f(d)?f(d)&&f(u)?M[7]:f(a)&&f(u)?M[2]:f(d)&&f(s)?M[5]:f(a)&&f(s)?M[0]:f(a)?M[1]:f(d)?M[6]:f(u)?M[3]:f(s)?M[4]:r<l&&a<l&&o<l?M[6]:h<l&&d<l&&m<l?M[1]:void 0:Object(x.sample)(P)},p=function(t){return function(e,n,r){var a=Object(k.a)(i,c,e);return m(a)?Object(x.sample)(P):d(a)?y(t,n,r):a>=.7&&a<.8?Object(x.sample)(T):a>=.8?Object(x.sample)(S):Object(x.sample)(C)}},b=p(u),g=u.map((function(t,e){return t.map((function(t,n){return b(t,n,e)}))}));return console.log("Min: ".concat(i,", Max: ").concat(c)),console.log("<0: ".concat(o,", >0: ").concat(s)),console.log("Seed: ".concat(n)),g}(100,100),100,100),n=e.map,r=e.finder,a=e.costMatrix,i=e.spawnPoint,c=e.terrainLayer;this.finder=r,this.terrainLayer=c;var o=n.tileWidth,s=n.tileHeight,u=this.addPlayer().addArmy(i.x*o,i.y*s,"warrior");u.body.setInteractive().on("pointerdown",(function(){return t.target=u})),this.target=u,this.setupCamera(c.width,c.height),this.camera.centerOn(this.target.body.x,this.target.body.y),this.movement=U(this,a,o,s),this.createMapControls(),this.input.on("pointerdown",this.onPointerDown),this.scene.run("UI")}},{key:"update",value:function(t,e){this.controls.update(e),this.camera.setZoom(o.Math.Clamp(this.camera.zoom,.08,1))}}]),e}(I),H={physics:{default:"arcade",arcade:{gravity:{y:0}}},type:s.a.AUTO,width:800,height:600,parent:"App",pixelArt:!0,scene:[_,j]};new o.Game(H);var N=function(){return a.a.createElement("div",{className:"App",id:"App"})};c.a.render(a.a.createElement(N,null),document.getElementById("root"))},566:function(t,e,n){t.exports=n(1495)},571:function(t,e,n){},572:function(t,e,n){}},[[566,1,2]]]);
//# sourceMappingURL=main.d3a55b60.chunk.js.map