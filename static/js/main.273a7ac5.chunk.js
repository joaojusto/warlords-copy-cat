(this.webpackJsonpwarlords_copy_cat=this.webpackJsonpwarlords_copy_cat||[]).push([[0],{1494:function(t,e,n){"use strict";n.r(e);var r=n(125),a=n.n(r),i=n(562),o=n.n(i),c=(n(570),n(571),n(41)),s=n.n(c),u=n(42),l=n(33),h=n(563),d=n(27),m=n(47),f=[2],p=[4,5,6],y=[8,9,10,11,12,13,14,15],b=[1],g=[3,7],v=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Math.random(),r=new h.Noise;r.seed(n);var a=12*t/100,i=0,o=0,c=0,s=0,u=Object(d.range)(e).map((function(e){return Object(d.range)(t).map((function(t){var n=r.perlin2(t/a,e/a);return i=n<i?n:i,o=n>o?n:o,n<0?c++:s++,n}))})),l=.45,v=l+.1,O=function(t){return t>=l&&t<v},j=function(t){return t<l},w=function(t){return!O(t)&&!j(t)},x=function(t,e,n){if(n-1<0||n+1>=t.length)return Object(d.sample)(g);if(e-1<0||e+1>=t.length)return Object(d.sample)(g);var r=Object(m.a)(i,o,t[n-1][e-1]),a=Object(m.a)(i,o,t[n-1][e]),c=Object(m.a)(i,o,t[n-1][e+1]),s=Object(m.a)(i,o,t[n][e-1]),u=Object(m.a)(i,o,t[n][e+1]),h=Object(m.a)(i,o,t[n+1][e-1]),f=Object(m.a)(i,o,t[n+1][e]),p=Object(m.a)(i,o,t[n+1][e+1]);return w(a)||w(s)||w(u)||w(f)?w(f)&&w(u)?y[7]:w(a)&&w(u)?y[2]:w(f)&&w(s)?y[5]:w(a)&&w(s)?y[0]:w(a)?y[1]:w(f)?y[6]:w(u)?y[3]:w(s)?y[4]:r<l&&a<l&&c<l?y[6]:h<l&&f<l&&p<l?y[1]:void 0:Object(d.sample)(g)},k=function(t){return function(e,n,r){var a=Object(m.a)(i,o,e);return j(a)?Object(d.sample)(g):O(a)?x(t,n,r):a>=.7&&a<.8?Object(d.sample)(p):a>=.8?Object(d.sample)(b):Object(d.sample)(f)}},C=k(u),T=u.map((function(t,e){return t.map((function(t,n){return C(t,n,e)}))}));return console.log("Min: ".concat(i,", Max: ").concat(o)),console.log("<0: ".concat(c,", >0: ").concat(s)),console.log("Seed: ".concat(n)),T},O=n(104),j=n(167),w=n(169),x=n(168),k=n(170),C=function(t){function e(){return Object(O.a)(this,e),Object(w.a)(this,Object(x.a)(e).apply(this,arguments))}return Object(k.a)(e,t),Object(j.a)(e,[{key:"createMapControls",value:function(){var t=c.Input.Keyboard.KeyCodes,e=t.Q,n=t.E,r=c.Cameras.Controls.SmoothedKeyControl,a=this.input.keyboard.createCursorKeys(),i=a.left,o=a.right,s={up:a.up,down:a.down,left:i,right:o,camera:this.camera,zoomIn:this.keyboard.addKey(e),zoomOut:this.keyboard.addKey(n),drag:.6,maxSpeed:200,acceleration:2.8};this.controls=new r(s)}},{key:"setupCamera",value:function(t,e){var n=this.camera,r=n.width,a=n.height;this.camera.setBounds(0,0,t,e),this.camera.setScroll(-r/2+t/2,-a/2+e/2)}},{key:"controls",get:function(){return this.mapControls},set:function(t){this.mapControls=t}},{key:"camera",get:function(){return this.cameras.main}},{key:"keyboard",get:function(){return this.input.keyboard}},{key:"width",get:function(){return this.game.config.width}},{key:"height",get:function(){return this.game.config.height}},{key:"finder",get:function(){return this.pathFinder},set:function(t){this.pathFinder=t}},{key:"movement",get:function(){return this.entityMover},set:function(t){this.entityMover=t}},{key:"minimap",get:function(){return this.minimapCamera},set:function(t){this.minimapCamera=t}},{key:"target",get:function(){return this.selectedTarget},set:function(t){this.selectedTarget=t}}]),e}(c.Scene),T=n(564),M=n.n(T),P=102,S=102,A=10,E=2,I=8772,B="minimap",D={path:[],cost:0,totalCost:0,currentTurn:[],nextTurns:[],indicators:[],nextIndicators:[]},F=function(t,e,n,r){var a=t.add.graphics(),i=D,o=function(t){return t*n},s=function(t){return t*r},h=function(){a.destroy(),a=t.add.graphics(),i=D},m=function(t){var e=t.x,i=t.y,u={x:o(e)+n/2,y:s(i)+r/2},l=new c.Geom.Circle(u.x,u.y,8);return a.fillCircleShape(l),l},f=function(e){return function(){t.camera.stopFollow(e.body),h()}};return{move:function(n){return function(r){if(!r||r.length<=1)return h();if(i&&i.currentTurn.length&&Object(d.isEqual)(i.path,r))return function(e){var n=i,r=n.cost,a=n.currentTurn.map((function(t){var n=t.x,r=t.y;return{targets:e.body,x:{value:o(n),duration:200},y:{value:s(r),duration:200}}}));t.camera.startFollow(e.body),t.tweens.timeline({tweens:a,onComplete:f(e)}),e.spendMovement(r)}(n);h();var c=r.slice(1,r.length).reduce(function(t,e){return function(n,r){var a=r.x,i=r.y,o=n.cost,c=n.totalCost,s=n.currentTurn,h=n.nextTurns,d=t[i][a];return c+d<=e.movementPoints?Object(l.a)({},n,{cost:o+d,totalCost:c+d,currentTurn:[].concat(Object(u.a)(s),[{x:a,y:i}])}):Object(l.a)({},n,{nextTurns:[].concat(Object(u.a)(h),[{x:a,y:i}])})}}(e,n),Object(l.a)({},D,{path:r})),p=c.currentTurn,y=c.nextTurns;a.fillStyle(16777215,1),c.indicators=p.map(m),a.fillStyle(16711680,1),c.nextIndicators=y.map(m),i=c}},clear:h}},K={turn:1,name:"",money:0,armies:[],castles:[]},L=function t(e,n,r,a){var i=this;Object(O.a)(this,t),this.spendMovement=function(t){return i.movementPoints-=t},this.resetMovement=function(){return i.movementPoints=4},this.scene=e,this.movementPoints=4,this.body=e.physics.add.sprite(n,r,a).setDisplaySize(24,24).setDisplayOrigin(-42,-44)},W=function(t,e){var n=Object(l.a)({},K,{name:"Player ".concat(e)});return{state:n,name:function(){return n.name},turn:function(){return n.turn},endTurn:function(){n.armies.forEach((function(t){return t.resetMovement()})),n=Object(l.a)({},n,{turn:n.turn+1})},addArmy:function(e,r,a){var i=new L(t,e,r,a);return n=Object(l.a)({},n,{armies:[].concat(Object(u.a)(n.armies),[i])}),i}}},z=function(t,e){return{x:Math.floor(t/128),y:Math.floor(e/128)}},_=function(t){function e(){var t;return Object(O.a)(this,e),(t=Object(w.a)(this,Object(x.a)(e).call(this,arguments))).onPointerDown=function(e){var n=e.worldX,r=e.worldY,a=z(n,r),i=z(t.target.body.x,t.target.body.y),o=t.movement.move(t.target);try{t.finder.findPath(i.x,i.y,a.x,a.y,o),t.finder.calculate()}catch(c){console.error("Ups! Out of scope :S")}},t.players=[],t}return Object(k.a)(e,t),Object(j.a)(e,[{key:"addPlayer",value:function(){var t=this.players.length,e=W(this,t);return this.players.push(e),e}},{key:"preload",value:function(){this.load.setBaseURL("".concat("/warlords-copy-cat")),this.load.image("tiles","tilesets/tileset-extruded.png"),this.load.image("warrior","warrior.png")}},{key:"create",value:function(){var t=function(t,e,n,r){var a,i=t.make.tilemap({tileWidth:128,tileHeight:128}),o=i.tileWidth,c=i.tileHeight,s=i.addTilesetImage("tilemap","tiles",o,c,1,2),l=i.createBlankDynamicLayer("terrain",s,0,0,n,r,o,c),h=new M.a.js;h.setGrid(e),h.setAcceptableTiles([].concat(Object(u.a)(f),Object(u.a)(b),Object(u.a)(p))),h.enableDiagonals();var m=[],y=function(t,e){return function(n,r,a,i){e.setTileCost(n,i),t[a]=t[a]||[],t[a][r]=i}}(m,h);return e.forEach((function(t,e){return t.forEach((function(t,n){a||Object(d.includes)(g,t)||(a={x:n,y:e}),l.putTileAt(t,n,e),Object(d.includes)(f,t)&&y(t,n,e,1),Object(d.includes)(p,t)&&y(t,n,e,2),Object(d.includes)(b,t)&&y(t,n,e,3)}))})),l=i.convertLayerToStatic(l),{map:i,finder:h,costMatrix:m,spawnPoint:a,terrainLayer:l}}(this,v(100,100),100,100),e=t.map,n=t.finder,r=t.costMatrix,a=t.spawnPoint,i=t.terrainLayer;this.finder=n;var o=e.tileWidth,c=e.tileHeight,s=this.addPlayer();this.target=s.addArmy(a.x*o,a.y*c,"warrior"),this.minimap=function(t,e,n){var r=P,a=S,i=A,o=B,c=I,s=(a-E)/n,u={x:e/2,y:n/2},l={x:t.width-r-i,y:i};return t.cameras.add(l.x,l.y,r,a).setZoom(s).setName(o).centerOn(u.x,u.y).setBackgroundColor(c)}(this,i.width,i.height),this.setupCamera(i.width,i.height),this.camera.centerOn(this.target.body.x,this.target.body.y),this.movement=F(this,r,o,c),this.createMapControls(),this.input.on("pointerdown",this.onPointerDown);var l=this.add.text(20,20,"Current Player: ".concat(s.name(),", turn: ").concat(s.turn()),{fill:"#000000"}).setScrollFactor(0);this.add.text(700,560,"End Turn",{fill:"#000000"}).setScrollFactor(0).setInteractive().on("pointerdown",(function(){s.endTurn(),l.setText("Current Player: ".concat(s.name(),", turn: ").concat(s.turn()))}))}},{key:"update",value:function(t,e){this.controls.update(e),this.camera.setZoom(c.Math.Clamp(this.camera.zoom,.08,1))}}]),e}(C),G={physics:{default:"arcade",arcade:{gravity:{y:0}}},type:s.a.AUTO,width:800,height:600,parent:"App",pixelArt:!0,scene:_};new c.Game(G);var H=function(){return a.a.createElement("div",{className:"App",id:"App"})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(H,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)}))},565:function(t,e,n){t.exports=n(1494)},570:function(t,e,n){},571:function(t,e,n){}},[[565,1,2]]]);
//# sourceMappingURL=main.273a7ac5.chunk.js.map